<div class="loader" *ngIf = "loading_list">
  <div class="loding-logo">
    <mat-spinner></mat-spinner>
  </div>
</div>
<div class="main-container" *ngIf = "!loading_list" >
  <div class="offer-container">
    <div class="row">
      <div class="col s7 padding0">
        <div class="sprate-box">
          <div class="full-offer">
            <div class="top-heading">
              <h2>Customer DETAIL</h2>
              <div class="no-fixed">
                <button *ngIf="getData.status == 'Pending'" mat-button (click)="edit()"><i class="material-icons">edit</i></button>
              </div>
            </div>
            
            <div class="detail-info">
              <!-- <div class="img-box">
                
                
                <div class="name-box point-sec" (click)="balanceModel(getData.id)">
                  <div class="points ">
                    <a  >{{getData.balance_point}}</a>
                    <h4>Point</h4>
                  </div>
                </div>
              </div> -->
              
              <div class="basic-details">
                <div class="profile-info">
                  <ul>
                    
                    <li>
                      <figure>
                        <div class="left-img border">
                          <ng-container *ngIf="getData.profile">
                            <img [src]="getData.profile" (click)="openDialog( getData.customer_id,'test5')" >
                          </ng-container>
                          <ng-container *ngIf="!getData.profile">
                            <img src="assets/male.svg">
                          </ng-container>
                        </div>
                        <div class="right-cont">
                          <p>Name</p>
                          <span>{{getData.first_name | titlecase }} {{getData.last_name | titlecase }}</span>
                        </div>
                      </figure>
                    </li>
                    <li>
                      
                      <figure>
                        <div class="left-img">
                          <img src="assets/contact.svg">
                        </div>
                        <div class="right-cont">
                          <p>Mobile No.</p>
                          <span>{{getData.mobile_no}}</span>
                        </div>
                      </figure>
                      
                    </li>
                    
                    
                    <li>
                      <figure>
                        <div class="left-img">
                          <img src="assets/book.svg">
                        </div>
                        <div class="right-cont">
                          <p>Address</p>
                          <span>{{getData.address | titlecase }}   {{getData.city | titlecase }} {{getData.district | titlecase }} {{getData.state | titlecase }} {{getData.pincode}}</span>
                          
                        </div>
                      </figure>
                      
                    </li>
                    
                    
                    
                    <li *ngIf="getData.status == 'Cancel'">
                      <figure>
                        <div class="left-img">
                          <img src="assets/book.svg">
                        </div>
                        <div class="right-cont">
                          <p>Reason :</p>
                          <span>{{getData.cancel_date | date:'d MMMM y'}} / {{ getData.cancelled_by}}</span>
                          <p>{{getData.reason_cancel}}</p>
                        </div>
                      </figure>
                      
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div> 
        </div>
      </div>
      
      <div class="col s5 padding0 pl15">
        <div class="sprate-box gift-offer">
          <div class="full-offer">
            <div class="top-heading">
              <h2>PLUMBER DETAIL</h2>
              <div class="btn-23">
                <button *ngIf="getData.status == 'Pending'" (click)="assignPlumber(getData.id, getData.assigned_plumber)" >Assign Plumber</button>
              </div>
            </div>
            <div class="sprate-box defult">
              <div class="detail-info defult-css">
                
                <div class="basic-details">
                  <div class="profile-info">
                    <p *ngIf="getData.sales_name == null ">Waiting for a Plumber Assign</p>
                    <ul *ngIf="getData.sales_name">
                      <li>
                        <a> <i class="material-icons"> account_circle</i></a>
                        <div class="margin">
                          <p>Name</p>
                          <span>{{getData.sales_name}}</span>
                        </div>
                      </li>
                      <li>
                        <a><i class="material-icons">local_phone</i></a>
                        <div class="margin">
                          <p>Mobile No.</p>
                          <span>{{getData.sales_mobile}}</span>
                        </div>
                      </li>
                    </ul>
                  </div>
                  
                  
                  
                  
                  <div class="col s8"  *ngIf="getData.sales_name">
                    <div class="review-se">
                      <ul>
                        <li [ngClass]="{'star':getData.star>='1'}"><i class="material-icons"  >
                          star
                        </i></li>
                        <li  [ngClass]="{'star':getData.star>='2'}"><i class="material-icons">
                          star
                        </i></li>
                        <li [ngClass]="{'star':getData.star>='3'}"><i class="material-icons" >
                          star
                        </i></li>
                        <li [ngClass]="{'star':getData.star>='4'}"><i class="material-icons" >
                          star
                        </i></li>
                        <li  [ngClass]="{'star':getData.star>='5'}"><i class="material-icons">
                          star
                        </i></li>
                      </ul>
                    </div>
                  </div>
                  
                  
                  
                  
                </div>
                
                
              </div>
            </div>
            
          </div>
        </div>
      </div>
    </div>
    
    <div class="row">
      
      
      <div class="col s4 padding0 ">
        <div class="sprate-box gift-offer">
          <div class="full-offer">
            <div class="top-heading">
              <h2>COMPLAINT DETAIL</h2>
            </div>
            <div class="sprate-box defult">
              <div class="detail-info defult-css">
                
                <div class="basic-details">
                  <div class="complant-detail">
                    <ul>
                      
                      <li>
                        <h3>Date Created</h3>
                        <p>{{getData.date_created |  date:'d MMMM y'}}
                        </p>
                      </li>
                      <li>
                        <h3>Created By</h3>
                        <p *ngIf="getData.created_by == '0'">App</p>
                        <p *ngIf="getData.created_by == '1'">Admin</p>
                      </li>
                      <li>
                        <h3>Complaint Id</h3>
                        <p>COM#{{getData.id}}
                        </p>
                      </li>
                      <li>
                        <h3>Nature Problem</h3>
                        <p>{{getData.nature_problem}}
                        </p>
                      </li>
                      <li>
                        <h3>Visit
                            <button (click)="openRemark( getData.id )">Remark</button>
                        </h3>
                        
                      </li>
                      
                        
                      <li *ngIf="getData.status == 'Closed'">
                        <h3>Customer Paid Amount </h3>
                        <p>{{getData.amount}}
                        </p>
                      </li>

                        <li>
                          
                          <h3>status
                            
                            <button *ngIf="getData.status == 'Pending'"  (click)="changeStatus(i, getData.id, getData.status )">change status</button>
                          </h3>
                          <p class="{{getData.status}}" *ngIf="getData.status == 'Pending'">{{getData.status}}</p>
                          
                          <p class="{{getData.status}}" *ngIf="getData.status ==  'Cancel' || getData.status == 'Closed' " >{{getData.status}}</p>
                          
                          
                          
                        </li>
                        <li *ngIf="getData.status == 'Closed'">
                          <h3 >Close Date</h3>
                          <p>{{getData.cancel_date != '0000-00-00 00:00:00' ? ( getData.cancel_date  |  date:'d MMMM y' ) : '' }}
                          </p>
                        </li>
                        <li *ngIf="getData.status == 'Closed'">
                          <h3 >Close Remark</h3>
                          <p>{{getData.reason_cancel}}
                          </p>
                        </li>

                        <li *ngIf="getData.status == 'Cancel'">
                            <h3 >Cancel Date</h3>
                            <p>{{getData.cancel_date != '0000-00-00 00:00:00' ? ( getData.cancel_date  |  date:'d MMMM y' ) : '' }}
                            </p>
                          </li>
                          <li *ngIf="getData.status == 'Cancel'">
                            <h3 >Cancel Remark</h3>
                            <p>{{getData.reason_cancel}}
                            </p>
                          </li>
                          <li>
                          
                            <h3>Dealer Name And Mobile </h3>
                              
                        
                            
                            <p >{{getData.dealer_name | titlecase}} - {{getData.dealer_mobile}}</p>
                            
                            
                            
                          </li>

                          <li *ngIf="getData.status == 'Closed'&& getData.plumber_payment ==0 ||getData.plumber_payment ==''||getData.plumber_payment ==null">
                          
                            <h3>Add Plumber Payment
                              
                              <button  (click)="addPayment(getData.assigned_plumber,getData.id)">Add</button>
                            </h3>
                            
                          </li>

                          <li *ngIf="getData.status == 'Closed'&&  getData.plumber_payment">
                          
                            <h3> Plumber Paid  Amount
                              
                            
                            </h3>
                            <p>{{getData.plumber_payment}}</p>
                            
                          </li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="col s4 padding0 pl15">
          <div class="sprate-box gift-offer">
            <div class="full-offer">
              <div class="top-heading">
                <h2>COMPLAINT IMAGE</h2>
                <div class="add-co"><i class="material-icons" (click)="editGallery()">add</i></div>
              </div>
              <div class="sprate-box defult">
                <div class="detail-info defult-css">
                  
                  <div class="basic-details">
                    
                    <div class="multi-img">
                      <ul>
                        <ng-container *ngIf="image">
                          <ng-container *ngFor="let g of getData.image; let i = index" >
                            
                            <li *ngIf="g.type == 'image'">
                              <img [src]="db.myurl+'app/uploads/'+g.file_name"  (click)="openDialog4(g.id,'test16')" >
                              <div class="delete-icn" (click)="deleteGallery(g.id)">
                                <i class="material-icons">delete_sweep</i>
                              </div>
                            </li>
                          </ng-container>
                        </ng-container>
                        <ng-container *ngIf="!image">
                          <img src="assets/no-ima.png">
                        </ng-container>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="col s4 padding0 pl15">
          <div class="sprate-box gift-offer">
            <div class="full-offer">
              <div class="top-heading">
                <h2>COMPLAINT VIDEO</h2>
                <div class="add-co"><i class="material-icons" (click)="editGallery()">add</i></div>
              </div>
              <div class="sprate-box defult">
                <div class="detail-info defult-css">
                  
                  <div class="basic-details">
                    <div class="multi-img multi-video">
                      <ul>
                        <ng-container *ngIf="video">
                          <ng-container *ngFor="let g of getData.image; let i = index" >
                            <li *ngIf="g.type == 'video'">
                              <iframe width="100%" height="100%"  [src]="db.myurl+'app/uploads/'+g.file_name | safe" frameborder="0" 
                              allow="accelerometer;  encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                              <div class="delete-icn" (click)="deleteGallery(g.id)">
                                <i class="material-icons">delete_sweep</i>
                              </div>
                            </li>
                          </ng-container>
                        </ng-container>
                      </ul>
                      <ng-container *ngIf="!video">
                        <img src="assets/no-video.png">
                      </ng-container>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
      </div>
    </div>
  </div>
  
  
  
  
  